{"ast":null,"code":"\"use strict\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar EnterLeaveCounter_1 = require(\"./EnterLeaveCounter\");\nvar BrowserDetector_1 = require(\"./BrowserDetector\");\nvar OffsetUtils_1 = require(\"./OffsetUtils\");\nvar NativeDragSources_1 = require(\"./NativeDragSources\");\nvar NativeTypes = require(\"./NativeTypes\");\nvar autobind_decorator_1 = require(\"autobind-decorator\");\nvar defaults = require('lodash/defaults');\nvar shallowEqual = require('shallowequal');\nvar HTML5Backend = /** @class */function () {\n  function HTML5Backend(manager) {\n    this.sourcePreviewNodes = new Map();\n    this.sourcePreviewNodeOptions = new Map();\n    this.sourceNodes = new Map();\n    this.sourceNodeOptions = new Map();\n    this.enterLeaveCounter = new EnterLeaveCounter_1.default();\n    this.dragStartSourceIds = null;\n    this.dropTargetIds = [];\n    this.dragEnterTargetIds = [];\n    this.currentNativeSource = null;\n    this.currentNativeHandle = null;\n    this.currentDragSourceNode = null;\n    this.currentDragSourceNodeOffset = null;\n    this.currentDragSourceNodeOffsetChanged = false;\n    this.altKeyPressed = false;\n    this.mouseMoveTimeoutTimer = null;\n    this.asyncEndDragFrameId = null;\n    this.dragOverTargetIds = null;\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.registry = manager.getRegistry();\n    this.context = manager.getContext();\n  }\n  Object.defineProperty(HTML5Backend.prototype, \"window\", {\n    // public for test\n    get: function () {\n      if (this.context && this.context.window) {\n        return this.context.window;\n      } else if (typeof window !== 'undefined') {\n        return window;\n      }\n      return undefined;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  HTML5Backend.prototype.setup = function () {\n    if (this.window === undefined) {\n      return;\n    }\n    if (this.window.__isReactDndBackendSetUp) {\n      throw new Error('Cannot have two HTML5 backends at the same time.');\n    }\n    this.window.__isReactDndBackendSetUp = true;\n    this.addEventListeners(this.window);\n  };\n  HTML5Backend.prototype.teardown = function () {\n    if (this.window === undefined) {\n      return;\n    }\n    this.window.__isReactDndBackendSetUp = false;\n    this.removeEventListeners(this.window);\n    this.clearCurrentDragSourceNode();\n    if (this.asyncEndDragFrameId) {\n      this.window.cancelAnimationFrame(this.asyncEndDragFrameId);\n    }\n  };\n  HTML5Backend.prototype.connectDragPreview = function (sourceId, node, options) {\n    var _this = this;\n    this.sourcePreviewNodeOptions.set(sourceId, options);\n    this.sourcePreviewNodes.set(sourceId, node);\n    return function () {\n      _this.sourcePreviewNodes.delete(sourceId);\n      _this.sourcePreviewNodeOptions.delete(sourceId);\n    };\n  };\n  HTML5Backend.prototype.connectDragSource = function (sourceId, node, options) {\n    var _this = this;\n    this.sourceNodes.set(sourceId, node);\n    this.sourceNodeOptions.set(sourceId, options);\n    var handleDragStart = function (e) {\n      return _this.handleDragStart(e, sourceId);\n    };\n    var handleSelectStart = function (e) {\n      return _this.handleSelectStart(e);\n    };\n    node.setAttribute('draggable', true);\n    node.addEventListener('dragstart', handleDragStart);\n    node.addEventListener('selectstart', handleSelectStart);\n    return function () {\n      _this.sourceNodes.delete(sourceId);\n      _this.sourceNodeOptions.delete(sourceId);\n      node.removeEventListener('dragstart', handleDragStart);\n      node.removeEventListener('selectstart', handleSelectStart);\n      node.setAttribute('draggable', false);\n    };\n  };\n  HTML5Backend.prototype.connectDropTarget = function (targetId, node) {\n    var _this = this;\n    var handleDragEnter = function (e) {\n      return _this.handleDragEnter(e, targetId);\n    };\n    var handleDragOver = function (e) {\n      return _this.handleDragOver(e, targetId);\n    };\n    var handleDrop = function (e) {\n      return _this.handleDrop(e, targetId);\n    };\n    node.addEventListener('dragenter', handleDragEnter);\n    node.addEventListener('dragover', handleDragOver);\n    node.addEventListener('drop', handleDrop);\n    return function () {\n      node.removeEventListener('dragenter', handleDragEnter);\n      node.removeEventListener('dragover', handleDragOver);\n      node.removeEventListener('drop', handleDrop);\n    };\n  };\n  HTML5Backend.prototype.addEventListeners = function (target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.addEventListener) {\n      return;\n    }\n    target.addEventListener('dragstart', this.handleTopDragStart);\n    target.addEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.addEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.addEventListener('dragenter', this.handleTopDragEnter);\n    target.addEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.addEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.addEventListener('dragover', this.handleTopDragOver);\n    target.addEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.addEventListener('drop', this.handleTopDrop);\n    target.addEventListener('drop', this.handleTopDropCapture, true);\n  };\n  HTML5Backend.prototype.removeEventListeners = function (target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.removeEventListener) {\n      return;\n    }\n    target.removeEventListener('dragstart', this.handleTopDragStart);\n    target.removeEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.removeEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.removeEventListener('dragenter', this.handleTopDragEnter);\n    target.removeEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.removeEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.removeEventListener('dragover', this.handleTopDragOver);\n    target.removeEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.removeEventListener('drop', this.handleTopDrop);\n    target.removeEventListener('drop', this.handleTopDropCapture, true);\n  };\n  HTML5Backend.prototype.getCurrentSourceNodeOptions = function () {\n    var sourceId = this.monitor.getSourceId();\n    var sourceNodeOptions = this.sourceNodeOptions.get(sourceId);\n    return defaults(sourceNodeOptions || {}, {\n      dropEffect: this.altKeyPressed ? 'copy' : 'move'\n    });\n  };\n  HTML5Backend.prototype.getCurrentDropEffect = function () {\n    if (this.isDraggingNativeItem()) {\n      // It makes more sense to default to 'copy' for native resources\n      return 'copy';\n    }\n    return this.getCurrentSourceNodeOptions().dropEffect;\n  };\n  HTML5Backend.prototype.getCurrentSourcePreviewNodeOptions = function () {\n    var sourceId = this.monitor.getSourceId();\n    var sourcePreviewNodeOptions = this.sourcePreviewNodeOptions.get(sourceId);\n    return defaults(sourcePreviewNodeOptions || {}, {\n      anchorX: 0.5,\n      anchorY: 0.5,\n      captureDraggingState: false\n    });\n  };\n  HTML5Backend.prototype.getSourceClientOffset = function (sourceId) {\n    return OffsetUtils_1.getNodeClientOffset(this.sourceNodes.get(sourceId));\n  };\n  HTML5Backend.prototype.isDraggingNativeItem = function () {\n    var itemType = this.monitor.getItemType();\n    return Object.keys(NativeTypes).some(function (key) {\n      return NativeTypes[key] === itemType;\n    });\n  };\n  HTML5Backend.prototype.beginDragNativeItem = function (type) {\n    this.clearCurrentDragSourceNode();\n    var SourceType = NativeDragSources_1.createNativeDragSource(type);\n    this.currentNativeSource = new SourceType();\n    this.currentNativeHandle = this.registry.addSource(type, this.currentNativeSource);\n    this.actions.beginDrag([this.currentNativeHandle]);\n  };\n  HTML5Backend.prototype.endDragNativeItem = function () {\n    if (!this.isDraggingNativeItem()) {\n      return;\n    }\n    this.actions.endDrag();\n    this.registry.removeSource(this.currentNativeHandle);\n    this.currentNativeHandle = null;\n    this.currentNativeSource = null;\n  };\n  HTML5Backend.prototype.isNodeInDocument = function (node) {\n    // Check the node either in the main document or in the current context\n    return !!document && document.body.contains(node) || !!this.window && this.window.document.body.contains(node);\n  };\n  HTML5Backend.prototype.endDragIfSourceWasRemovedFromDOM = function () {\n    var node = this.currentDragSourceNode;\n    if (this.isNodeInDocument(node)) {\n      return;\n    }\n    if (this.clearCurrentDragSourceNode()) {\n      this.actions.endDrag();\n    }\n  };\n  HTML5Backend.prototype.setCurrentDragSourceNode = function (node) {\n    var _this = this;\n    this.clearCurrentDragSourceNode();\n    this.currentDragSourceNode = node;\n    this.currentDragSourceNodeOffset = OffsetUtils_1.getNodeClientOffset(node);\n    this.currentDragSourceNodeOffsetChanged = false;\n    // A timeout of > 0 is necessary to resolve Firefox issue referenced\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n    var MOUSE_MOVE_TIMEOUT = 1000;\n    // Receiving a mouse event in the middle of a dragging operation\n    // means it has ended and the drag source node disappeared from DOM,\n    // so the browser didn't dispatch the dragend event.\n    //\n    // We need to wait before we start listening for mousemove events.\n    // This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n    // immediately in some browsers.\n    //\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n    //\n    this.mouseMoveTimeoutTimer = setTimeout(function () {\n      return _this.window && _this.window.addEventListener('mousemove', _this.endDragIfSourceWasRemovedFromDOM, true);\n    }, MOUSE_MOVE_TIMEOUT);\n  };\n  HTML5Backend.prototype.clearCurrentDragSourceNode = function () {\n    if (this.currentDragSourceNode) {\n      this.currentDragSourceNode = null;\n      this.currentDragSourceNodeOffset = null;\n      this.currentDragSourceNodeOffsetChanged = false;\n      if (this.window) {\n        this.window.clearTimeout(this.mouseMoveTimeoutTimer);\n        this.window.removeEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n      }\n      this.mouseMoveTimeoutTimer = null;\n      return true;\n    }\n    return false;\n  };\n  HTML5Backend.prototype.checkIfCurrentDragSourceRectChanged = function () {\n    var node = this.currentDragSourceNode;\n    if (!node) {\n      return false;\n    }\n    if (this.currentDragSourceNodeOffsetChanged) {\n      return true;\n    }\n    this.currentDragSourceNodeOffsetChanged = !shallowEqual(OffsetUtils_1.getNodeClientOffset(node), this.currentDragSourceNodeOffset);\n    return this.currentDragSourceNodeOffsetChanged;\n  };\n  HTML5Backend.prototype.handleTopDragStartCapture = function () {\n    this.clearCurrentDragSourceNode();\n    this.dragStartSourceIds = [];\n  };\n  HTML5Backend.prototype.handleDragStart = function (e, sourceId) {\n    if (!this.dragStartSourceIds) {\n      this.dragStartSourceIds = [];\n    }\n    this.dragStartSourceIds.unshift(sourceId);\n  };\n  HTML5Backend.prototype.handleTopDragStart = function (e) {\n    var _this = this;\n    var dragStartSourceIds = this.dragStartSourceIds;\n    this.dragStartSourceIds = null;\n    var clientOffset = OffsetUtils_1.getEventClientOffset(e);\n    // Avoid crashing if we missed a drop event or our previous drag died\n    if (this.monitor.isDragging()) {\n      this.actions.endDrag();\n    }\n    // Don't publish the source just yet (see why below)\n    this.actions.beginDrag(dragStartSourceIds || [], {\n      publishSource: false,\n      getSourceClientOffset: this.getSourceClientOffset,\n      clientOffset: clientOffset\n    });\n    var dataTransfer = e.dataTransfer;\n    var nativeType = NativeDragSources_1.matchNativeItemType(dataTransfer);\n    if (this.monitor.isDragging()) {\n      if (typeof dataTransfer.setDragImage === 'function') {\n        // Use custom drag image if user specifies it.\n        // If child drag source refuses drag but parent agrees,\n        // use parent's node as drag image. Neither works in IE though.\n        var sourceId = this.monitor.getSourceId();\n        var sourceNode = this.sourceNodes.get(sourceId);\n        var dragPreview = this.sourcePreviewNodes.get(sourceId) || sourceNode;\n        var _a = this.getCurrentSourcePreviewNodeOptions(),\n          anchorX = _a.anchorX,\n          anchorY = _a.anchorY,\n          offsetX = _a.offsetX,\n          offsetY = _a.offsetY;\n        var anchorPoint = {\n          anchorX: anchorX,\n          anchorY: anchorY\n        };\n        var offsetPoint = {\n          offsetX: offsetX,\n          offsetY: offsetY\n        };\n        var dragPreviewOffset = OffsetUtils_1.getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint);\n        dataTransfer.setDragImage(dragPreview, dragPreviewOffset.x, dragPreviewOffset.y);\n      }\n      try {\n        // Firefox won't drag without setting data\n        dataTransfer.setData('application/json', {});\n      } catch (err) {\n        // IE doesn't support MIME types in setData\n      }\n      // Store drag source node so we can check whether\n      // it is removed from DOM and trigger endDrag manually.\n      this.setCurrentDragSourceNode(e.target);\n      // Now we are ready to publish the drag source.. or are we not?\n      var captureDraggingState = this.getCurrentSourcePreviewNodeOptions().captureDraggingState;\n      if (!captureDraggingState) {\n        // Usually we want to publish it in the next tick so that browser\n        // is able to screenshot the current (not yet dragging) state.\n        //\n        // It also neatly avoids a situation where render() returns null\n        // in the same tick for the source element, and browser freaks out.\n        setTimeout(function () {\n          return _this.actions.publishDragSource();\n        }, 0);\n      } else {\n        // In some cases the user may want to override this behavior, e.g.\n        // to work around IE not supporting custom drag previews.\n        //\n        // When using a custom drag layer, the only way to prevent\n        // the default drag preview from drawing in IE is to screenshot\n        // the dragging state in which the node itself has zero opacity\n        // and height. In this case, though, returning null from render()\n        // will abruptly end the dragging, which is not obvious.\n        //\n        // This is the reason such behavior is strictly opt-in.\n        this.actions.publishDragSource();\n      }\n    } else if (nativeType) {\n      // A native item (such as URL) dragged from inside the document\n      this.beginDragNativeItem(nativeType);\n    } else if (!dataTransfer.types && (!e.target.hasAttribute || !e.target.hasAttribute('draggable'))) {\n      // Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n      // Just let it drag. It's a native type (URL or text) and will be picked up in\n      // dragenter handler.\n      return;\n    } else {\n      // If by this time no drag source reacted, tell browser not to drag.\n      e.preventDefault();\n    }\n  };\n  HTML5Backend.prototype.handleTopDragEndCapture = function () {\n    if (this.clearCurrentDragSourceNode()) {\n      // Firefox can dispatch this event in an infinite loop\n      // if dragend handler does something like showing an alert.\n      // Only proceed if we have not handled it already.\n      this.actions.endDrag();\n    }\n  };\n  HTML5Backend.prototype.handleTopDragEnterCapture = function (e) {\n    this.dragEnterTargetIds = [];\n    var isFirstEnter = this.enterLeaveCounter.enter(e.target);\n    if (!isFirstEnter || this.monitor.isDragging()) {\n      return;\n    }\n    var dataTransfer = e.dataTransfer;\n    var nativeType = NativeDragSources_1.matchNativeItemType(dataTransfer);\n    if (nativeType) {\n      // A native item (such as file or URL) dragged from outside the document\n      this.beginDragNativeItem(nativeType);\n    }\n  };\n  HTML5Backend.prototype.handleDragEnter = function (e, targetId) {\n    this.dragEnterTargetIds.unshift(targetId);\n  };\n  HTML5Backend.prototype.handleTopDragEnter = function (e) {\n    var _this = this;\n    var dragEnterTargetIds = this.dragEnterTargetIds;\n    this.dragEnterTargetIds = [];\n    if (!this.monitor.isDragging()) {\n      // This is probably a native item type we don't understand.\n      return;\n    }\n    this.altKeyPressed = e.altKey;\n    if (!BrowserDetector_1.isFirefox()) {\n      // Don't emit hover in `dragenter` on Firefox due to an edge case.\n      // If the target changes position as the result of `dragenter`, Firefox\n      // will still happily dispatch `dragover` despite target being no longer\n      // there. The easy solution is to only fire `hover` in `dragover` on FF.\n      this.actions.hover(dragEnterTargetIds, {\n        clientOffset: OffsetUtils_1.getEventClientOffset(e)\n      });\n    }\n    var canDrop = dragEnterTargetIds.some(function (targetId) {\n      return _this.monitor.canDropOnTarget(targetId);\n    });\n    if (canDrop) {\n      // IE requires this to fire dragover events\n      e.preventDefault();\n      e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n    }\n  };\n  HTML5Backend.prototype.handleTopDragOverCapture = function () {\n    this.dragOverTargetIds = [];\n  };\n  HTML5Backend.prototype.handleDragOver = function (e, targetId) {\n    if (this.dragOverTargetIds === null) {\n      this.dragOverTargetIds = [];\n    }\n    this.dragOverTargetIds.unshift(targetId);\n  };\n  HTML5Backend.prototype.handleTopDragOver = function (e) {\n    var _this = this;\n    var dragOverTargetIds = this.dragOverTargetIds;\n    this.dragOverTargetIds = [];\n    if (!this.monitor.isDragging()) {\n      // This is probably a native item type we don't understand.\n      // Prevent default \"drop and blow away the whole document\" action.\n      e.preventDefault();\n      e.dataTransfer.dropEffect = 'none';\n      return;\n    }\n    this.altKeyPressed = e.altKey;\n    this.actions.hover(dragOverTargetIds || [], {\n      clientOffset: OffsetUtils_1.getEventClientOffset(e)\n    });\n    var canDrop = (dragOverTargetIds || []).some(function (targetId) {\n      return _this.monitor.canDropOnTarget(targetId);\n    });\n    if (canDrop) {\n      // Show user-specified drop effect.\n      e.preventDefault();\n      e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n    } else if (this.isDraggingNativeItem()) {\n      // Don't show a nice cursor but still prevent default\n      // \"drop and blow away the whole document\" action.\n      e.preventDefault();\n      e.dataTransfer.dropEffect = 'none';\n    } else if (this.checkIfCurrentDragSourceRectChanged()) {\n      // Prevent animating to incorrect position.\n      // Drop effect must be other than 'none' to prevent animation.\n      e.preventDefault();\n      e.dataTransfer.dropEffect = 'move';\n    }\n  };\n  HTML5Backend.prototype.handleTopDragLeaveCapture = function (e) {\n    if (this.isDraggingNativeItem()) {\n      e.preventDefault();\n    }\n    var isLastLeave = this.enterLeaveCounter.leave(e.target);\n    if (!isLastLeave) {\n      return;\n    }\n    if (this.isDraggingNativeItem()) {\n      this.endDragNativeItem();\n    }\n  };\n  HTML5Backend.prototype.handleTopDropCapture = function (e) {\n    this.dropTargetIds = [];\n    e.preventDefault();\n    if (this.isDraggingNativeItem()) {\n      this.currentNativeSource.mutateItemByReadingDataTransfer(e.dataTransfer);\n    }\n    this.enterLeaveCounter.reset();\n  };\n  HTML5Backend.prototype.handleDrop = function (e, targetId) {\n    this.dropTargetIds.unshift(targetId);\n  };\n  HTML5Backend.prototype.handleTopDrop = function (e) {\n    var dropTargetIds = this.dropTargetIds;\n    this.dropTargetIds = [];\n    this.actions.hover(dropTargetIds, {\n      clientOffset: OffsetUtils_1.getEventClientOffset(e)\n    });\n    this.actions.drop({\n      dropEffect: this.getCurrentDropEffect()\n    });\n    if (this.isDraggingNativeItem()) {\n      this.endDragNativeItem();\n    } else {\n      this.endDragIfSourceWasRemovedFromDOM();\n    }\n  };\n  HTML5Backend.prototype.handleSelectStart = function (e) {\n    var target = e.target;\n    // Only IE requires us to explicitly say\n    // we want drag drop operation to start\n    if (typeof target.dragDrop !== 'function') {\n      return;\n    }\n    // Inputs and textareas should be selectable\n    if (target.tagName === 'INPUT' || target.tagName === 'SELECT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n      return;\n    }\n    // For other targets, ask IE\n    // to enable drag and drop\n    e.preventDefault();\n    target.dragDrop();\n  };\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"getSourceClientOffset\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"endDragNativeItem\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"isNodeInDocument\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"endDragIfSourceWasRemovedFromDOM\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragStartCapture\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragStart\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragEndCapture\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragEnterCapture\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragEnter\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragOverCapture\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragOver\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragLeaveCapture\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDropCapture\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDrop\", null);\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleSelectStart\", null);\n  return HTML5Backend;\n}();\nexports.default = HTML5Backend;","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","exports","value","EnterLeaveCounter_1","require","BrowserDetector_1","OffsetUtils_1","NativeDragSources_1","NativeTypes","autobind_decorator_1","defaults","shallowEqual","HTML5Backend","manager","sourcePreviewNodes","Map","sourcePreviewNodeOptions","sourceNodes","sourceNodeOptions","enterLeaveCounter","default","dragStartSourceIds","dropTargetIds","dragEnterTargetIds","currentNativeSource","currentNativeHandle","currentDragSourceNode","currentDragSourceNodeOffset","currentDragSourceNodeOffsetChanged","altKeyPressed","mouseMoveTimeoutTimer","asyncEndDragFrameId","dragOverTargetIds","actions","getActions","monitor","getMonitor","registry","getRegistry","context","getContext","prototype","get","window","undefined","enumerable","configurable","setup","__isReactDndBackendSetUp","Error","addEventListeners","teardown","removeEventListeners","clearCurrentDragSourceNode","cancelAnimationFrame","connectDragPreview","sourceId","node","options","_this","set","delete","connectDragSource","handleDragStart","e","handleSelectStart","setAttribute","addEventListener","removeEventListener","connectDropTarget","targetId","handleDragEnter","handleDragOver","handleDrop","handleTopDragStart","handleTopDragStartCapture","handleTopDragEndCapture","handleTopDragEnter","handleTopDragEnterCapture","handleTopDragLeaveCapture","handleTopDragOver","handleTopDragOverCapture","handleTopDrop","handleTopDropCapture","getCurrentSourceNodeOptions","getSourceId","dropEffect","getCurrentDropEffect","isDraggingNativeItem","getCurrentSourcePreviewNodeOptions","anchorX","anchorY","captureDraggingState","getSourceClientOffset","getNodeClientOffset","itemType","getItemType","keys","some","beginDragNativeItem","type","SourceType","createNativeDragSource","addSource","beginDrag","endDragNativeItem","endDrag","removeSource","isNodeInDocument","document","body","contains","endDragIfSourceWasRemovedFromDOM","setCurrentDragSourceNode","MOUSE_MOVE_TIMEOUT","setTimeout","clearTimeout","checkIfCurrentDragSourceRectChanged","unshift","clientOffset","getEventClientOffset","isDragging","publishSource","dataTransfer","nativeType","matchNativeItemType","setDragImage","sourceNode","dragPreview","_a","offsetX","offsetY","anchorPoint","offsetPoint","dragPreviewOffset","getDragPreviewOffset","x","y","setData","err","publishDragSource","types","hasAttribute","preventDefault","isFirstEnter","enter","altKey","isFirefox","hover","canDrop","canDropOnTarget","isLastLeave","leave","mutateItemByReadingDataTransfer","reset","drop","dragDrop","tagName","isContentEditable"],"sources":["C:/Users/gmlee/Downloads/LearnChessApp/node_modules/react-dnd-html5-backend/lib/HTML5Backend.js"],"sourcesContent":["\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EnterLeaveCounter_1 = require(\"./EnterLeaveCounter\");\nvar BrowserDetector_1 = require(\"./BrowserDetector\");\nvar OffsetUtils_1 = require(\"./OffsetUtils\");\nvar NativeDragSources_1 = require(\"./NativeDragSources\");\nvar NativeTypes = require(\"./NativeTypes\");\nvar autobind_decorator_1 = require(\"autobind-decorator\");\nvar defaults = require('lodash/defaults');\nvar shallowEqual = require('shallowequal');\nvar HTML5Backend = /** @class */ (function () {\n    function HTML5Backend(manager) {\n        this.sourcePreviewNodes = new Map();\n        this.sourcePreviewNodeOptions = new Map();\n        this.sourceNodes = new Map();\n        this.sourceNodeOptions = new Map();\n        this.enterLeaveCounter = new EnterLeaveCounter_1.default();\n        this.dragStartSourceIds = null;\n        this.dropTargetIds = [];\n        this.dragEnterTargetIds = [];\n        this.currentNativeSource = null;\n        this.currentNativeHandle = null;\n        this.currentDragSourceNode = null;\n        this.currentDragSourceNodeOffset = null;\n        this.currentDragSourceNodeOffsetChanged = false;\n        this.altKeyPressed = false;\n        this.mouseMoveTimeoutTimer = null;\n        this.asyncEndDragFrameId = null;\n        this.dragOverTargetIds = null;\n        this.actions = manager.getActions();\n        this.monitor = manager.getMonitor();\n        this.registry = manager.getRegistry();\n        this.context = manager.getContext();\n    }\n    Object.defineProperty(HTML5Backend.prototype, \"window\", {\n        // public for test\n        get: function () {\n            if (this.context && this.context.window) {\n                return this.context.window;\n            }\n            else if (typeof window !== 'undefined') {\n                return window;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HTML5Backend.prototype.setup = function () {\n        if (this.window === undefined) {\n            return;\n        }\n        if (this.window.__isReactDndBackendSetUp) {\n            throw new Error('Cannot have two HTML5 backends at the same time.');\n        }\n        this.window.__isReactDndBackendSetUp = true;\n        this.addEventListeners(this.window);\n    };\n    HTML5Backend.prototype.teardown = function () {\n        if (this.window === undefined) {\n            return;\n        }\n        this.window.__isReactDndBackendSetUp = false;\n        this.removeEventListeners(this.window);\n        this.clearCurrentDragSourceNode();\n        if (this.asyncEndDragFrameId) {\n            this.window.cancelAnimationFrame(this.asyncEndDragFrameId);\n        }\n    };\n    HTML5Backend.prototype.connectDragPreview = function (sourceId, node, options) {\n        var _this = this;\n        this.sourcePreviewNodeOptions.set(sourceId, options);\n        this.sourcePreviewNodes.set(sourceId, node);\n        return function () {\n            _this.sourcePreviewNodes.delete(sourceId);\n            _this.sourcePreviewNodeOptions.delete(sourceId);\n        };\n    };\n    HTML5Backend.prototype.connectDragSource = function (sourceId, node, options) {\n        var _this = this;\n        this.sourceNodes.set(sourceId, node);\n        this.sourceNodeOptions.set(sourceId, options);\n        var handleDragStart = function (e) { return _this.handleDragStart(e, sourceId); };\n        var handleSelectStart = function (e) { return _this.handleSelectStart(e); };\n        node.setAttribute('draggable', true);\n        node.addEventListener('dragstart', handleDragStart);\n        node.addEventListener('selectstart', handleSelectStart);\n        return function () {\n            _this.sourceNodes.delete(sourceId);\n            _this.sourceNodeOptions.delete(sourceId);\n            node.removeEventListener('dragstart', handleDragStart);\n            node.removeEventListener('selectstart', handleSelectStart);\n            node.setAttribute('draggable', false);\n        };\n    };\n    HTML5Backend.prototype.connectDropTarget = function (targetId, node) {\n        var _this = this;\n        var handleDragEnter = function (e) { return _this.handleDragEnter(e, targetId); };\n        var handleDragOver = function (e) { return _this.handleDragOver(e, targetId); };\n        var handleDrop = function (e) { return _this.handleDrop(e, targetId); };\n        node.addEventListener('dragenter', handleDragEnter);\n        node.addEventListener('dragover', handleDragOver);\n        node.addEventListener('drop', handleDrop);\n        return function () {\n            node.removeEventListener('dragenter', handleDragEnter);\n            node.removeEventListener('dragover', handleDragOver);\n            node.removeEventListener('drop', handleDrop);\n        };\n    };\n    HTML5Backend.prototype.addEventListeners = function (target) {\n        // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n        if (!target.addEventListener) {\n            return;\n        }\n        target.addEventListener('dragstart', this.handleTopDragStart);\n        target.addEventListener('dragstart', this.handleTopDragStartCapture, true);\n        target.addEventListener('dragend', this.handleTopDragEndCapture, true);\n        target.addEventListener('dragenter', this.handleTopDragEnter);\n        target.addEventListener('dragenter', this.handleTopDragEnterCapture, true);\n        target.addEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n        target.addEventListener('dragover', this.handleTopDragOver);\n        target.addEventListener('dragover', this.handleTopDragOverCapture, true);\n        target.addEventListener('drop', this.handleTopDrop);\n        target.addEventListener('drop', this.handleTopDropCapture, true);\n    };\n    HTML5Backend.prototype.removeEventListeners = function (target) {\n        // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n        if (!target.removeEventListener) {\n            return;\n        }\n        target.removeEventListener('dragstart', this.handleTopDragStart);\n        target.removeEventListener('dragstart', this.handleTopDragStartCapture, true);\n        target.removeEventListener('dragend', this.handleTopDragEndCapture, true);\n        target.removeEventListener('dragenter', this.handleTopDragEnter);\n        target.removeEventListener('dragenter', this.handleTopDragEnterCapture, true);\n        target.removeEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n        target.removeEventListener('dragover', this.handleTopDragOver);\n        target.removeEventListener('dragover', this.handleTopDragOverCapture, true);\n        target.removeEventListener('drop', this.handleTopDrop);\n        target.removeEventListener('drop', this.handleTopDropCapture, true);\n    };\n    HTML5Backend.prototype.getCurrentSourceNodeOptions = function () {\n        var sourceId = this.monitor.getSourceId();\n        var sourceNodeOptions = this.sourceNodeOptions.get(sourceId);\n        return defaults(sourceNodeOptions || {}, {\n            dropEffect: this.altKeyPressed ? 'copy' : 'move',\n        });\n    };\n    HTML5Backend.prototype.getCurrentDropEffect = function () {\n        if (this.isDraggingNativeItem()) {\n            // It makes more sense to default to 'copy' for native resources\n            return 'copy';\n        }\n        return this.getCurrentSourceNodeOptions().dropEffect;\n    };\n    HTML5Backend.prototype.getCurrentSourcePreviewNodeOptions = function () {\n        var sourceId = this.monitor.getSourceId();\n        var sourcePreviewNodeOptions = this.sourcePreviewNodeOptions.get(sourceId);\n        return defaults(sourcePreviewNodeOptions || {}, {\n            anchorX: 0.5,\n            anchorY: 0.5,\n            captureDraggingState: false,\n        });\n    };\n    HTML5Backend.prototype.getSourceClientOffset = function (sourceId) {\n        return OffsetUtils_1.getNodeClientOffset(this.sourceNodes.get(sourceId));\n    };\n    HTML5Backend.prototype.isDraggingNativeItem = function () {\n        var itemType = this.monitor.getItemType();\n        return Object.keys(NativeTypes).some(function (key) { return NativeTypes[key] === itemType; });\n    };\n    HTML5Backend.prototype.beginDragNativeItem = function (type) {\n        this.clearCurrentDragSourceNode();\n        var SourceType = NativeDragSources_1.createNativeDragSource(type);\n        this.currentNativeSource = new SourceType();\n        this.currentNativeHandle = this.registry.addSource(type, this.currentNativeSource);\n        this.actions.beginDrag([this.currentNativeHandle]);\n    };\n    HTML5Backend.prototype.endDragNativeItem = function () {\n        if (!this.isDraggingNativeItem()) {\n            return;\n        }\n        this.actions.endDrag();\n        this.registry.removeSource(this.currentNativeHandle);\n        this.currentNativeHandle = null;\n        this.currentNativeSource = null;\n    };\n    HTML5Backend.prototype.isNodeInDocument = function (node) {\n        // Check the node either in the main document or in the current context\n        return ((!!document && document.body.contains(node)) ||\n            (!!this.window && this.window.document.body.contains(node)));\n    };\n    HTML5Backend.prototype.endDragIfSourceWasRemovedFromDOM = function () {\n        var node = this.currentDragSourceNode;\n        if (this.isNodeInDocument(node)) {\n            return;\n        }\n        if (this.clearCurrentDragSourceNode()) {\n            this.actions.endDrag();\n        }\n    };\n    HTML5Backend.prototype.setCurrentDragSourceNode = function (node) {\n        var _this = this;\n        this.clearCurrentDragSourceNode();\n        this.currentDragSourceNode = node;\n        this.currentDragSourceNodeOffset = OffsetUtils_1.getNodeClientOffset(node);\n        this.currentDragSourceNodeOffsetChanged = false;\n        // A timeout of > 0 is necessary to resolve Firefox issue referenced\n        // See:\n        //   * https://github.com/react-dnd/react-dnd/pull/928\n        //   * https://github.com/react-dnd/react-dnd/issues/869\n        var MOUSE_MOVE_TIMEOUT = 1000;\n        // Receiving a mouse event in the middle of a dragging operation\n        // means it has ended and the drag source node disappeared from DOM,\n        // so the browser didn't dispatch the dragend event.\n        //\n        // We need to wait before we start listening for mousemove events.\n        // This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n        // immediately in some browsers.\n        //\n        // See:\n        //   * https://github.com/react-dnd/react-dnd/pull/928\n        //   * https://github.com/react-dnd/react-dnd/issues/869\n        //\n        this.mouseMoveTimeoutTimer = setTimeout(function () {\n            return (_this.window &&\n                _this.window.addEventListener('mousemove', _this.endDragIfSourceWasRemovedFromDOM, true));\n        }, MOUSE_MOVE_TIMEOUT);\n    };\n    HTML5Backend.prototype.clearCurrentDragSourceNode = function () {\n        if (this.currentDragSourceNode) {\n            this.currentDragSourceNode = null;\n            this.currentDragSourceNodeOffset = null;\n            this.currentDragSourceNodeOffsetChanged = false;\n            if (this.window) {\n                this.window.clearTimeout(this.mouseMoveTimeoutTimer);\n                this.window.removeEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n            }\n            this.mouseMoveTimeoutTimer = null;\n            return true;\n        }\n        return false;\n    };\n    HTML5Backend.prototype.checkIfCurrentDragSourceRectChanged = function () {\n        var node = this.currentDragSourceNode;\n        if (!node) {\n            return false;\n        }\n        if (this.currentDragSourceNodeOffsetChanged) {\n            return true;\n        }\n        this.currentDragSourceNodeOffsetChanged = !shallowEqual(OffsetUtils_1.getNodeClientOffset(node), this.currentDragSourceNodeOffset);\n        return this.currentDragSourceNodeOffsetChanged;\n    };\n    HTML5Backend.prototype.handleTopDragStartCapture = function () {\n        this.clearCurrentDragSourceNode();\n        this.dragStartSourceIds = [];\n    };\n    HTML5Backend.prototype.handleDragStart = function (e, sourceId) {\n        if (!this.dragStartSourceIds) {\n            this.dragStartSourceIds = [];\n        }\n        this.dragStartSourceIds.unshift(sourceId);\n    };\n    HTML5Backend.prototype.handleTopDragStart = function (e) {\n        var _this = this;\n        var dragStartSourceIds = this.dragStartSourceIds;\n        this.dragStartSourceIds = null;\n        var clientOffset = OffsetUtils_1.getEventClientOffset(e);\n        // Avoid crashing if we missed a drop event or our previous drag died\n        if (this.monitor.isDragging()) {\n            this.actions.endDrag();\n        }\n        // Don't publish the source just yet (see why below)\n        this.actions.beginDrag(dragStartSourceIds || [], {\n            publishSource: false,\n            getSourceClientOffset: this.getSourceClientOffset,\n            clientOffset: clientOffset,\n        });\n        var dataTransfer = e.dataTransfer;\n        var nativeType = NativeDragSources_1.matchNativeItemType(dataTransfer);\n        if (this.monitor.isDragging()) {\n            if (typeof dataTransfer.setDragImage === 'function') {\n                // Use custom drag image if user specifies it.\n                // If child drag source refuses drag but parent agrees,\n                // use parent's node as drag image. Neither works in IE though.\n                var sourceId = this.monitor.getSourceId();\n                var sourceNode = this.sourceNodes.get(sourceId);\n                var dragPreview = this.sourcePreviewNodes.get(sourceId) || sourceNode;\n                var _a = this.getCurrentSourcePreviewNodeOptions(), anchorX = _a.anchorX, anchorY = _a.anchorY, offsetX = _a.offsetX, offsetY = _a.offsetY;\n                var anchorPoint = { anchorX: anchorX, anchorY: anchorY };\n                var offsetPoint = { offsetX: offsetX, offsetY: offsetY };\n                var dragPreviewOffset = OffsetUtils_1.getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint);\n                dataTransfer.setDragImage(dragPreview, dragPreviewOffset.x, dragPreviewOffset.y);\n            }\n            try {\n                // Firefox won't drag without setting data\n                dataTransfer.setData('application/json', {});\n            }\n            catch (err) {\n                // IE doesn't support MIME types in setData\n            }\n            // Store drag source node so we can check whether\n            // it is removed from DOM and trigger endDrag manually.\n            this.setCurrentDragSourceNode(e.target);\n            // Now we are ready to publish the drag source.. or are we not?\n            var captureDraggingState = this.getCurrentSourcePreviewNodeOptions().captureDraggingState;\n            if (!captureDraggingState) {\n                // Usually we want to publish it in the next tick so that browser\n                // is able to screenshot the current (not yet dragging) state.\n                //\n                // It also neatly avoids a situation where render() returns null\n                // in the same tick for the source element, and browser freaks out.\n                setTimeout(function () { return _this.actions.publishDragSource(); }, 0);\n            }\n            else {\n                // In some cases the user may want to override this behavior, e.g.\n                // to work around IE not supporting custom drag previews.\n                //\n                // When using a custom drag layer, the only way to prevent\n                // the default drag preview from drawing in IE is to screenshot\n                // the dragging state in which the node itself has zero opacity\n                // and height. In this case, though, returning null from render()\n                // will abruptly end the dragging, which is not obvious.\n                //\n                // This is the reason such behavior is strictly opt-in.\n                this.actions.publishDragSource();\n            }\n        }\n        else if (nativeType) {\n            // A native item (such as URL) dragged from inside the document\n            this.beginDragNativeItem(nativeType);\n        }\n        else if (!dataTransfer.types &&\n            (!e.target.hasAttribute || !e.target.hasAttribute('draggable'))) {\n            // Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n            // Just let it drag. It's a native type (URL or text) and will be picked up in\n            // dragenter handler.\n            return;\n        }\n        else {\n            // If by this time no drag source reacted, tell browser not to drag.\n            e.preventDefault();\n        }\n    };\n    HTML5Backend.prototype.handleTopDragEndCapture = function () {\n        if (this.clearCurrentDragSourceNode()) {\n            // Firefox can dispatch this event in an infinite loop\n            // if dragend handler does something like showing an alert.\n            // Only proceed if we have not handled it already.\n            this.actions.endDrag();\n        }\n    };\n    HTML5Backend.prototype.handleTopDragEnterCapture = function (e) {\n        this.dragEnterTargetIds = [];\n        var isFirstEnter = this.enterLeaveCounter.enter(e.target);\n        if (!isFirstEnter || this.monitor.isDragging()) {\n            return;\n        }\n        var dataTransfer = e.dataTransfer;\n        var nativeType = NativeDragSources_1.matchNativeItemType(dataTransfer);\n        if (nativeType) {\n            // A native item (such as file or URL) dragged from outside the document\n            this.beginDragNativeItem(nativeType);\n        }\n    };\n    HTML5Backend.prototype.handleDragEnter = function (e, targetId) {\n        this.dragEnterTargetIds.unshift(targetId);\n    };\n    HTML5Backend.prototype.handleTopDragEnter = function (e) {\n        var _this = this;\n        var dragEnterTargetIds = this.dragEnterTargetIds;\n        this.dragEnterTargetIds = [];\n        if (!this.monitor.isDragging()) {\n            // This is probably a native item type we don't understand.\n            return;\n        }\n        this.altKeyPressed = e.altKey;\n        if (!BrowserDetector_1.isFirefox()) {\n            // Don't emit hover in `dragenter` on Firefox due to an edge case.\n            // If the target changes position as the result of `dragenter`, Firefox\n            // will still happily dispatch `dragover` despite target being no longer\n            // there. The easy solution is to only fire `hover` in `dragover` on FF.\n            this.actions.hover(dragEnterTargetIds, {\n                clientOffset: OffsetUtils_1.getEventClientOffset(e),\n            });\n        }\n        var canDrop = dragEnterTargetIds.some(function (targetId) {\n            return _this.monitor.canDropOnTarget(targetId);\n        });\n        if (canDrop) {\n            // IE requires this to fire dragover events\n            e.preventDefault();\n            e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n    };\n    HTML5Backend.prototype.handleTopDragOverCapture = function () {\n        this.dragOverTargetIds = [];\n    };\n    HTML5Backend.prototype.handleDragOver = function (e, targetId) {\n        if (this.dragOverTargetIds === null) {\n            this.dragOverTargetIds = [];\n        }\n        this.dragOverTargetIds.unshift(targetId);\n    };\n    HTML5Backend.prototype.handleTopDragOver = function (e) {\n        var _this = this;\n        var dragOverTargetIds = this.dragOverTargetIds;\n        this.dragOverTargetIds = [];\n        if (!this.monitor.isDragging()) {\n            // This is probably a native item type we don't understand.\n            // Prevent default \"drop and blow away the whole document\" action.\n            e.preventDefault();\n            e.dataTransfer.dropEffect = 'none';\n            return;\n        }\n        this.altKeyPressed = e.altKey;\n        this.actions.hover(dragOverTargetIds || [], {\n            clientOffset: OffsetUtils_1.getEventClientOffset(e),\n        });\n        var canDrop = (dragOverTargetIds || []).some(function (targetId) {\n            return _this.monitor.canDropOnTarget(targetId);\n        });\n        if (canDrop) {\n            // Show user-specified drop effect.\n            e.preventDefault();\n            e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n        else if (this.isDraggingNativeItem()) {\n            // Don't show a nice cursor but still prevent default\n            // \"drop and blow away the whole document\" action.\n            e.preventDefault();\n            e.dataTransfer.dropEffect = 'none';\n        }\n        else if (this.checkIfCurrentDragSourceRectChanged()) {\n            // Prevent animating to incorrect position.\n            // Drop effect must be other than 'none' to prevent animation.\n            e.preventDefault();\n            e.dataTransfer.dropEffect = 'move';\n        }\n    };\n    HTML5Backend.prototype.handleTopDragLeaveCapture = function (e) {\n        if (this.isDraggingNativeItem()) {\n            e.preventDefault();\n        }\n        var isLastLeave = this.enterLeaveCounter.leave(e.target);\n        if (!isLastLeave) {\n            return;\n        }\n        if (this.isDraggingNativeItem()) {\n            this.endDragNativeItem();\n        }\n    };\n    HTML5Backend.prototype.handleTopDropCapture = function (e) {\n        this.dropTargetIds = [];\n        e.preventDefault();\n        if (this.isDraggingNativeItem()) {\n            this.currentNativeSource.mutateItemByReadingDataTransfer(e.dataTransfer);\n        }\n        this.enterLeaveCounter.reset();\n    };\n    HTML5Backend.prototype.handleDrop = function (e, targetId) {\n        this.dropTargetIds.unshift(targetId);\n    };\n    HTML5Backend.prototype.handleTopDrop = function (e) {\n        var dropTargetIds = this.dropTargetIds;\n        this.dropTargetIds = [];\n        this.actions.hover(dropTargetIds, {\n            clientOffset: OffsetUtils_1.getEventClientOffset(e),\n        });\n        this.actions.drop({ dropEffect: this.getCurrentDropEffect() });\n        if (this.isDraggingNativeItem()) {\n            this.endDragNativeItem();\n        }\n        else {\n            this.endDragIfSourceWasRemovedFromDOM();\n        }\n    };\n    HTML5Backend.prototype.handleSelectStart = function (e) {\n        var target = e.target;\n        // Only IE requires us to explicitly say\n        // we want drag drop operation to start\n        if (typeof target.dragDrop !== 'function') {\n            return;\n        }\n        // Inputs and textareas should be selectable\n        if (target.tagName === 'INPUT' ||\n            target.tagName === 'SELECT' ||\n            target.tagName === 'TEXTAREA' ||\n            target.isContentEditable) {\n            return;\n        }\n        // For other targets, ask IE\n        // to enable drag and drop\n        e.preventDefault();\n        target.dragDrop();\n    };\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"getSourceClientOffset\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"endDragNativeItem\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"isNodeInDocument\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"endDragIfSourceWasRemovedFromDOM\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragStartCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragStart\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragEndCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragEnterCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragEnter\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragOverCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragOver\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragLeaveCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDropCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDrop\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleSelectStart\", null);\n    return HTML5Backend;\n}());\nexports.default = HTML5Backend;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}